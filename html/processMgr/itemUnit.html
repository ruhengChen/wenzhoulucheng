<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>三门峡黄河公铁两用桥信息系统</title>
    <link rel="stylesheet" href="../../bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../plugins/daterangepicker/daterangepicker.css">
    <link rel="stylesheet" href='../../plugins/zTree/css/blueStyle/blueStyle.css'>
    <link rel="stylesheet" href="../../plugins/jquery/alert/css/xcConfirm.css">
    <link rel="stylesheet" href="../../css/base.css">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/userMgr.css">
    <style>
        #unitTable{
            width: 1300px;
            overflow-x: auto;
        }
        .table-container {
            height: calc(100% - 130px);
        }
    </style>
</head>
<body>
<header class="ysh-smxHead">
    <div class="ysh-smxTitle">
        <img class="smxLogo" src="../../images/home/logo.png" alt="">
        <h5>三门峡黄河公铁两用桥信息系统</h5>
    </div>
    <ul id="loginOk" class="ysh-XTList">
        <li><a href="javascript:;">退出系统</a></li>
        <li><a href="javascript:;">消息<span class="xtInfo"></span></a></li>
        <li><span class="xiUser"></span>，欢迎使用本系统！</li>
    </ul>
</header>
<div class="ysh-menu">
    <ul class="ysh-menuList">
        <li><a href="../main.html">首页</a></li>
        <li><a href="../itemGK/itemIntro.html">工程概况</a></li>
        <li ><a  href="../userMgr.html">人员管理</a></li>

        <li class="wsMgr">
            <a href="javascript:;">物设管理</a>
            <ul class="wsCont ysh-disappear">
                <li><a href="../wsMgr/equipment.html">机械设备</a></li>
                <li><a href="../wsMgr/materialMgr.html">材料设备</a></li>
            </ul>
        </li>
        <li>
            <a href="javascript:;">进度管理</a>
            <ul class="jdCont ysh-disappear">
                <li><a href="itemUnit.html">项目单位</a></li>
                <li><a href="sgPlan.html">总施工进度</a></li>
            </ul>
        </li>
        <li>
            <a href="../safeMgr/safeUserMgr.html">安全管理</a>
        </li>
        <li>
            <a  href="javascript:;">质量管理</a>
            <ul class="zlCont ysh-disappear">
                <li><a class="reportMgr" href="../zlMgr/reportMgr.html">检测报告</a></li>
            </ul>
        </li>
        <li><a href="javascript:;">风险管理</a></li>
        <li><a href="../jsMgr/datumMgr.html">技术管理</a></li>
        <li><a href="javascript:;">试验管理</a></li>
        <li><a href="javascript:;">视频监控</a></li>
        <li class="sysMgr">
            <a href="javascript:;">系统管理</a>
            <ul class="sysCont ysh-disappear">
                <li><a class="attrMgr" href="../sysMgr/attrMgr.html">属性管理</a></li>
                <li><a class="attrMgr" href="../sysMgr/materialTypeMgr.html">材料类型</a></li>
            </ul>
        </li>
    </ul>
</div>
<div class="container">
    <div class="sidebar">
        <div class="treeToolBar">
            <span class="addTree addSg"></span>
            <span class="editTree editSg"></span>
            <span class="delTree delSg"></span>
            <span class="seeTree"></span>
        </div>
        <div class="treeContain">
            <ul id="treeUnit" class="ztree"></ul>
        </div>

    </div>
    <div class="mainContent">
        <div id="tableToolBar" class="tableTitle">
            <!--<span class="addUser"><b></b>增加</span>-->
            <!--<span class="editUser"><b></b>修改</span>-->
            <!--<span class="delUser"><b></b>删除</span>-->
            <!--<span class="seeUser"><b></b>查看</span>-->
            <!--<button class="btn btn-default addUser">增加</button>-->
            <!--<button class="btn btn-default editUser">修改</button>-->
            <!--<button class="btn btn-default delUser">删除</button>-->
            <!--<button class="btn btn-default seeUser">查看</button>-->
        </div>
        <!--<table id="ysh-unitTable"></table>-->
        <div class="table-container">
            <table id="unitTable" class="table table-striped planTable">
                <thead>
                <tr>
                    <th style=" ">序号</th>
                    <th style=" ">编号</th>
                    <th  style=" ">名称</th>
                    <!--<th style="">类型</th>-->
                    <!--<th style=" ">施工工艺流程</th>-->
                    <th style=" ">负责人</th>
                    <th style="">计划起始日期</th>
                    <th style=" ">计划结束日期</th>
                    <th style=" ">实际起始日期</th>
                    <th style=" ">实际结束日期</th>
                    <th style="">备注</th>
                    <!--<th>附加属性</th>-->
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td colspan="12">请选择项目工程</td>
                </tr>

                </tbody>
            </table>

        </div>
        <div class="tableToolBar">
            <button class="btn btn-default planTime">计划时间</button>
            <button class="btn btn-default sjTime">实际时间</button>
            <button class="btn btn-default seeAll">查看详情</button>
            <button class="btn btn-default otherAttr">附加属性</button>
        </div>
    </div>
</div>
<!--项目单位增加修改模态框-->
<div class="modal fade" id="SgModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"  aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="SgModalLabel"></h4>
            </div>
            <div class="modal-body" style="height: 400px;overflow-x: hidden;overflow-y: auto">
                <form id="sgForm" class="form-horizontal">
                    <div class="form-group">
                        <label for="sgName" class="col-sm-3 control-label">名称</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="sgName" data-sgId="" value="">
                            <!--<input type="text" class="form-control" id="sgName" data-sgId="" :duplex="@sgUnit_Info.NAME">-->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="sgBNo" class="col-sm-3 control-label">用户编号</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="sgBNo" >
                            <!--<input type="text" class="form-control" id="sgBNo" :duplex="@sgUnit_Info.UNO">-->
                        </div>
                    </div>
                    <!--<div class="form-group">-->
                        <!--<label for="sgType" class="col-sm-3 control-label">类型</label>-->
                        <!--<div class="col-sm-9">-->
                            <!--<select class="form-control" name="" id="sgType">-->
                                <!--<option value="1">分项工程</option>-->
                                <!--<option value="2">子分项工程</option>-->
                                <!--<option value="3">子子分项工程</option>-->
                            <!--</select>-->
                        <!--</div>-->
                    <!--</div>-->
                    <!--<div class="form-group">-->
                        <!--<label for="sgGy" class="col-sm-3 control-label">施工工艺流程</label>-->
                        <!--<div class="col-sm-9">-->
                            <!--<input type="text" class="form-control" id="sgGy">-->
                        <!--</div>-->
                    <!--</div>-->
                    <div class="form-group">
                        <label for="sgManager" class="col-sm-3 control-label">负责人</label>
                        <div class="col-sm-9">
                            <!--<input type="text" class="form-control" id="sgManager" :duplex="@sgUnit_Info.MANAGER">-->
                            <input type="text" class="form-control" id="sgManager" >
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pStartDate" class="col-sm-3 control-label">计划起始日期</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control ysh-pStartTime" id="pstartDate" >
                            <!--<input type="text" class="form-control ysh-pStartTime" id="pstartDate" :duplex="@sgUnit_Info.PSTART">-->
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pEndDate" class="col-sm-3 control-label">计划结束日期</label>
                        <div class="col-sm-9">
                            <!--<input type="text" class="form-control ysh-pEndTime" id="pEndDate" :duplex="@sgUnit_Info.PEND">-->
                            <input type="text" class="form-control ysh-pEndTime" id="pEndDate">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sStartDate" class="col-sm-3 control-label">实际起始日期</label>
                        <div class="col-sm-9">
                            <!--<input type="text" class="form-control ysh-sStartTime" id="sStartDate" :duplex="@sgUnit_Info.SSTART">-->
                            <input type="text" class="form-control ysh-sStartTime" id="sStartDate">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sEndDate" class="col-sm-3 control-label">实际结束日期</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control ysh-sEndTime" id="sEndDate">
                            <!--<input type="text" class="form-control ysh-sEndTime" id="sEndDate" :duplex="@sgUnit_Info.SEND">-->
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="remark" class="col-sm-3 control-label">备注</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="remark" >
                            <!--<input type="text" class="form-control" id="remark" :duplex="@sgUnit_Info.REK">-->
                        </div>
                    </div>
                    <div class="form-group"style="visibility: hidden">
                        <label for="sgNo" class="col-sm-3 control-label">编号</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="sgNo">
                            <!--<input type="text" class="form-control" id="sgNo" :duplex="@sgUnit_Info.NO">-->
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="addSgModal">确定</button>
                <button type="button" class="btn btn-primary" id="editSgModal">确定</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>

            </div>
        </div>
    </div>
</div>
<!--属性管理模态框-->
<div id="attrDataModal" data-pid="" data-ownerid=""  aria-hidden="true" data-backdrop="static" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="certModalTitle" >附加属性管理</h4>
            </div>
            <div class="modal-body" style="height: 400px;overflow-x: hidden;overflow-y: auto">
                <div id="Use-toolbar">
                    <button class="btn btn-default addOtherAttr">增加</button>
                    <button class="btn btn-default editOtherAttr">修改</button>
                    <button class="btn btn-default delOtherAttr">删除</button>
                    <!--<button class="btn btn-default seeUseMaterial">查看</button>-->
                </div>
                <!--<table id="eventTable"></table>-->
                <div class="table-container">
                    <table id="attrTable" data-ownerid=""
                           class="table table-striped planTable">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>属性名称</th>
                            <th>属性值</th>
                            <!--<th>描述</th>-->
                        </tr>
                        </thead>
                        <tbody>

                        </tbody>

                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!--附加属性增加修改模态框-->
<div class="modal fade" id="otherAttrModal" data-pid="" data-ownerid="" tabindex="-1" role="dialog"  aria-labelledby="myModalLabel"  aria-hidden="true" data-backdrop="static">>
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="otherAttrModalLabel"></h4>
            </div>
            <div class="modal-body" style="height: 400px;overflow-x: hidden;overflow-y: auto">
                <form id="otherAttrForm" class="form-horizontal">
                    <div class="form-group">
                        <label for="sxName" class="col-sm-3 control-label">属性名称</label>
                        <div class="col-sm-9">
                            <select name="" class="form-control"  id="sxName"></select>
                            <!--<input type="text" class="form-control" id="attrName" data-sgId="" value="">-->
                            <!--<input type="text" class="form-control" id="sgName" data-sgId="" :duplex="@sgUnit_Info.NAME">-->
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="attrVal" class="col-sm-3 control-label">属性值</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="attrVal" >
                            <!--<input type="text" class="form-control" id="sgBNo" :duplex="@sgUnit_Info.UNO">-->
                        </div>
                    </div>
                    <!--<div class="form-group">-->
                        <!--<label for="attrWd" class="col-sm-3 control-label">描述</label>-->
                        <!--<div class="col-sm-9">-->
                            <!--<input type="text" class="form-control" id="attrWd" >-->
                            <!--&lt;!&ndash;<input type="text" class="form-control" id="sgBNo" :duplex="@sgUnit_Info.UNO">&ndash;&gt;-->
                        <!--</div>-->
                    <!--</div>-->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="addAttrSub">确定</button>
                <button type="button" class="btn btn-primary" id="editAttrSub">确定</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>

            </div>
        </div>
    </div>
</div>
<!--计划时间模态框-->
<div id="planTimeModal" class="modal fade" tabindex="-1" role="dialog"  aria-hidden="true" data-backdrop="static">>
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">计划时间</h4>
            </div>
            <div class="modal-body" style="height: 180px;overflow-y: auto">
                <form id="planTimeForm" class="form-horizontal">
                    <div class="form-group" >
                        <label for="startTime" class="col-sm-3 control-label">计划起始日期</label>
                        <div class="col-sm-9">
                            <input type="text" id="startTime" class="form-control ysh-pStartTime" >
                            <!--<input type="text" class="form-control ysh-pStartTime" id="pstartDate" :duplex="@sgUnit_Info.PSTART">-->
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="endTime" class="col-sm-3 control-label">计划结束日期</label>
                        <div class="col-sm-9">
                            <input type="text" id="endTime" class="form-control ysh-pEndTime" >
                            <!--<input type="text" class="form-control ysh-pStartTime" id="pstartDate" :duplex="@sgUnit_Info.PSTART">-->
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <!--<button type="button" class="btn btn-primary" id="addPlanTimeModal">确定</button>-->
                <button type="button" class="btn btn-primary" id="editPlanTimeBtn">确定</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>

            </div>
            <!--<div class="modal-footer">-->
            <!---->
            <!--</div>-->
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--实际时间模态框-->
<div id="actuallyTimeModal" class="modal fade" tabindex="-1" role="dialog"  aria-hidden="true" data-backdrop="static">>
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">实际时间</h4>
            </div>
            <div class="modal-body" style="height: 180px;overflow-y: auto">
                <form id="sjTimeForm" class="form-horizontal">
                    <div class="form-group" >
                        <label for="startTime" class="col-sm-3 control-label">实际起始日期</label>
                        <div class="col-sm-9">
                            <input type="text" id="sstartTime" class="form-control ysh-pStartTime" >
                            <!--<input type="text" class="form-control ysh-pStartTime" id="pstartDate" :duplex="@sgUnit_Info.PSTART">-->
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="endTime" class="col-sm-3 control-label">实际结束日期</label>
                        <div class="col-sm-9">
                            <input type="text" id="sendTime" class="form-control ysh-pEndTime" >
                            <!--<input type="text" class="form-control ysh-pStartTime" id="pstartDate" :duplex="@sgUnit_Info.PSTART">-->
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <!--<button type="button" class="btn btn-primary" id="addPlanTimeModal">确定</button>-->
                <button type="button" class="btn btn-primary" id="editSjTimeBtn">确定</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>

            </div>
            <!--<div class="modal-footer">-->
            <!---->
            <!--</div>-->
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--所有属性模态框-->
<div class="modal fade" id="allAttrModal" data-pid="" data-ownerid="" tabindex="-1" role="dialog"  aria-labelledby="myModalLabel"  aria-hidden="true" data-backdrop="static">>
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="allAttrModalLabel">所有数据</h4>
            </div>
            <div class="modal-body" style="height: 400px;overflow-x: hidden;overflow-y: auto">
                <!--<div class="table-container">-->
                    <table id="allAttrTable" data-ownerid=""
                           class="table table-striped planTable">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>名称</th>
                            <th>值</th>
                        </tr>
                        </thead>
                        <tbody class="allBasicAttr">
                            <tr>
                                <td>1</td>
                                <td>编号</td>
                                <td class="buno"></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>名称</td>
                                <td class="buname"></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>负责人</td>
                                <td class="bumanager"></td>
                            </tr>

                            <tr>
                                <td>4</td>
                                <td>计划起始日期</td>
                                <td class="pstart"></td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>计划结束日期</td>
                                <td class="pend"></td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>实际起始日期</td>
                                <td class="sstart"></td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td>实际结束日期</td>
                                <td class="send"></td>
                            </tr>
                            <tr>
                                <td>8</td>
                                <td>备注</td>
                                <td class="remark"></td>
                            </tr>
                        </tbody>
                        <tbody class="allOtherAttr">

                        </tbody>
                    </table>
                <!--</div>-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>

            </div>
        </div>
    </div>
</div>

<script src="../../js/jquery-2.1.4.min.js"></script>
<script src="../../bootstrap/js/bootstrap.min.js"></script>
<script src="../../plugins/zTree/js/jquery.ztree.all.min.js"></script>
<script src="../../plugins/daterangepicker/moment.js"></script>
<script src="../../plugins/daterangepicker/daterangepicker.js"></script>
<script src="../../plugins/toastr/toastr.min.js"></script>
<script src="../../plugins/jquery/alert/js/xcConfirm.js"></script>
<script src="../../js/global.js"></script>
<script>
    (function ($) {
        var date = new Date(),baseURL=window.global.SMXprogramURL, zNodes=[],sgId='',tableSelector='#ysh-unitTable',
                buNo,nodeLength,planTimeAllContent={},actuallyAllContent={},
                protocols={
                    getUnit:baseURL +'buildunit/SHQBuildUnitGet',
                    addSg:baseURL+'buildunit/SHQBuildUnitAdd',
                    editSg:baseURL+'buildunit/SHQBuildUnitEdit',
                    getOtherAttr:baseURL+'property/SHQPropertyGet',
                    delOtherAttr:baseURL+'property/SHQPropertyDel',
                    editOtherAttr:baseURL+'property/SHQPropertyEdit',
                    addOtherAttr:baseURL+'property/SHQPropertyAdd',
                    getAttr:baseURL+'property/SHQPDictionaryGet',
                },ztree,uName,last,today = date.getFullYear()+'-'+(date.getMonth()+1)+'-'+date.getDate(),
                startTime = today,
                endTime = today;
        last = (date.getFullYear()-20)+'-'+(date.getMonth()+1)+'-'+date.getDate();
        var mainHeight = (window.innerHeight - 140)+'px';
        $('.container,.mainContent').innerHeight(mainHeight);
        $(window).resize(function(){
            mainHeight = (window.innerHeight - 140)+'px';
            $('.container,.mainContent').innerHeight(mainHeight);
        });
        uName  = sessionStorage.getItem('PNAME');
        if(uName){
            $('#btnLogin').css('display','none');
            $('#loginOk').removeClass('ysh-disappear');
            $('#loginOk .xiUser').text(uName);
        }
        //配置datepicker
        $('.ysh-pStartTime,.ysh-pEndTime,.ysh-sStartTime,.ysh-sEndTime').daterangepicker({
            locale: {
                format : 'YYYY-MM-DD',
                separator: ' ~ ',
                weekLabel: '星期',
            },
            startDate:startTime,
            singleDatePicker:true,
            timePicker:true,
            timePicker24Hour:true
        });
        //绑定事件
        $('.ysh-menuList a').on('click',showList);
        $('.wsCont a').on('click',hideList);
        document.onclick = function(){
            $('.jdCont,.wsCont,.sysCont,.zlCont,.aqCont').addClass('ysh-disappear');
        }
        //新增工程单位
        $('.addSg').on('click',addSg);
        //修改工程单位
        $('.editSg').on('click',editSg);
        $('.delSg').on('click',delSg);
        //项目单位（施工）
        $('#addSgModal').on('click',addSgModal);
        $('#editSgModal').on('click',editSgModal);
        //附加属性新增修改

        $('.otherAttr').on('click',attrModal);
        $('.addOtherAttr').on('click',showAttrAdd);
        $('.editOtherAttr').on('click',showAttrEdit);
        $('.delOtherAttr').on('click',delAttr);

        $('#addAttrSub').on('click',subAddAttrBtn);
        $('#editAttrSub').on('click',subEditAttrBtn);

        $('.planTime').on('click',planTimeBtn);
        $('.sjTime').on('click',sjTimeBtn);
        $('.seeAll').on('click',seeAllBtn);
        $('#editPlanTimeBtn').on('click',editPlanTimeBtn);
        $('#editSjTimeBtn').on('click',editSjTimeBtn);
        //初始化zTree
        var setting = {
            data: {
                check:{
                    enable:true
                },
                key:{
                    name:'BUName'
                },
                simpleData: {
                    enable: true,
                    idKey:'BUNo',
                    pIdKey:'pId',
                    rootPId:null
                },
                view:{
                    showLine:true,
                    showIcon:true
                }
            },
            callback: {
                beforeMouseDown:beforeMouseDown,
                onMouseDown: onMouseDown,
            }
        };
        //加载树数据
        $.ajax({
            url:protocols.getUnit,
            type:'get',
            cache:false,
            data:{

            },
            success:function (data) {
                if(!data.code){
                    //alert(data.msg);
                    zNodes = treeDataReconstruct(data.rows);

                    //console.log(d);
                }
                //渲染zTree
                ztree =  $.fn.zTree.init($("#treeUnit"), setting, zNodes);
            },
            error:function (data) {
                alert(data.msg)
            }
        });
        //二级列表显示
        function showList(e) {
            window.event? window.event.cancelBubble = true : e.stopPropagation();
            if($(this).parent().has('ul')){
                $('.jdCont,.wsCont,.sysCont,.zlCont,.aqCont').addClass('ysh-disappear');
                $(this).siblings('ul').removeClass('ysh-disappear');
            }
        }
        function hideList(e) {
            window.event? window.event.cancelBubble = true : e.stopPropagation();
            $(this).parent().parent().addClass('ysh-disappear');

        }
        //treeDataReconstruct();修改左边树数据结构
        function treeDataReconstruct(data) {
            //alert('1')
            $.each(data,function (i,o) {
                if(o.BUNo.length < 3){
                    o.pId ='0'
                }else{
                    var s  = o.BUNo.slice(0,-3);
                    o.pId = s;
                }
            });
            return data;
        }
        //鼠标点击之前
        function beforeMouseDown(treeId, treeNode) {
            if(!treeNode){
                return false;
            }else{
                return true;
            }
        }
        //鼠标点击
        function onMouseDown(event,treeId,treeNode) {
            console.log(treeNode);
            sgId = treeNode.BUID;
            buNo = treeNode.BUNo;
            var s =treeNode.BUName;
            var doc = $('.tableTitle');
            checkAllParents(treeNode,s,doc);


            var data  = getChildNodes(treeNode);

            var ids = [];
            ids = getChildren(ids,treeNode);
            nodeLength = (ids.length+1);
            console.log(ids.length);
            $('#unitTable>tbody').empty();
            if(ids.length){
                $.each(ids,function(i,o){
                    console.log(o.BUName);
                    var t = '<tr data-buid="'+o.BUID+'" data-no="'+o.BUNo+'">' +
                            '<td>' +(i+1)+'</td><td class="uNo">'+o.UNo+'</td><td class="buName">'+o.BUName+'</td><td class="buManager">'+o.BUManager+'</td>' +
                            '<td class="pstart">'+o.PStartDate+'</td><td class="pend">'+o.PEndDate+'</td>' +
                            '<td class="sStart">'+o.SStartDate+'</td><td class="sEnd">'+o.SEndDate+'</td>' +
                            '<td class="remark">'+o.Remark+'</td>' +
                            '</tr>';
                    $('#unitTable>tbody').append(t);
                    $('#unitTable>tbody>tr>td').on('click',function () {
                        $(this).parent().addClass('table-selected');
                        $(this).parent().siblings().removeClass('table-selected');
                    });
                });
            }else{
                    $('#unitTable>tbody').empty();
                    $('#unitTable>tbody').append('<tr><td colspan="12">该项目工程暂无数据</td></tr>');

            }

            //alert(treeNode ? treeNode.BUID + ", " + treeNode.BUName : "isRoot");
        }
        function checkAllParents(treeNode,string,doc){
            if (!treeNode.pId) {
                doc.text(string);
                return string;

            }else{
                treeNode.checked=true;
                string = treeNode.getParentNode().BUName + "-" + string;
                checkAllParents(treeNode.getParentNode(),string,doc);
            }
        }

        function getChildNodes(treeNode) {
            var childNodes = ztree.transformToArray(treeNode);
            var nodes = new Array();
            for(i = 0; i < childNodes.length; i++) {
                nodes[i] = childNodes[i];
            }
            return nodes;
        }
        function getChildren(ids,treeNode){
//            ids.push(treeNode.id);
            if(treeNode.isParent){
                console.log(treeNode.children.length)
                for(i = 0; i < treeNode.children.length; i++) {
                    ids[i] =  treeNode.children[i];
                }
            }
            return ids;
        }
        //添加工程单位（施工）模态框
        function addSg() {
            $('#SgModalLabel').text('添加施工单位');
            var num;
            if(sgId){
                if(nodeLength >= 10){
                    num = buNo+'-'+nodeLength;
                }else{
                    num = buNo+'-0'+nodeLength;
                }
                $('#sgName').attr('data-sgId','');
                $('#sgName').val('');
                $('#sgNo').val(num);
                $('#sgBNo').val('');
                $('#sgManager').val('');
                $('#pstartDate').val('');
                $('#pEndDate').val('');
                $('#sStartDate').val('');
                $('#sEndDate').val('');
                $('#remark').val('');
                $('#SgModal button#addSgModal').css('display','inline-block');
                $('#SgModal button#editSgModal').css('display','none');
                $('#SgModal').modal('show');
            }else{
                var root = ztree.getNodes();
                var rootLth = (root.length + 1);
                if(rootLth>= 10){
                    num = rootLth;
                }else{
                    num = '0'+rootLth;
                }
                $('#sgName').attr('data-sgId','');
                $('#sgName').val('');
                $('#sgNo').val(num);
                $('#sgBNo').val('');
                $('#sgManager').val('');
                $('#pstartDate').val('');
                $('#pEndDate').val('');
                $('#sStartDate').val('');
                $('#sEndDate').val('');
                $('#remark').val('');
                $('#SgModal button#addSgModal').css('display','inline-block');
                $('#SgModal button#editSgModal').css('display','none');
                $('#SgModal').modal('show');
//                alert('请选择父节点');
//                window.wxc.xcConfirm('请选择父节点', window.wxc.xcConfirm.typeEnum.confirm);
            }

        }
        //编辑工程单位（施工）模态框
        function editSg() {
            if(sgId==''){
//                alert('请选择需编辑项目节点');
                window.wxc.xcConfirm('请选择需编辑项目节点', window.wxc.xcConfirm.typeEnum.confirm);
            }else{
                $.each(zNodes,function (i,o) {
                    console.log(o)
                    if(o.BUID == sgId){
                        $('#sgName').attr('data-sgId',sgId);
                        $('#sgName').val(o.BUName);
                        $('#sgNo').val(o.BUNo);
                        $('#sgBNo').val(o.UNo);
                        $('#sgManager').val(o.BUManager);
                        $('#pstartDate').val(o.PStartDate);
                        $('#pEndDate').val(o.PEndDate);
                        $('#sStartDate').val(o.SStartDate);
                        $('#sEndDate').val(o.SEndDate);
                        $('#remark').val(o.Remark);
                    }
                });
                $('#SgModalLabel').text('修改施工单位');
                $('#SgModal button#addSgModal').css('display','none');
                $('#SgModal button#editSgModal').css('display','inline-block');
                $('#SgModal').modal('show');
            }
        }
        //删除工程单位（施工
        function delSg() {
            if(sgId==''){
//                alert('请选择需删除项目节点');
                window.wxc.xcConfirm('请选择需删除项目节点', window.wxc.xcConfirm.typeEnum.confirm);
            }else{
                window.wxc.xcConfirm('确认删除该项目？', window.wxc.xcConfirm.typeEnum.confirm,{
                    onOk:function () {
                        $.ajax({
                            url: baseURL + 'buildunit/SHQBuildUnitDel',
                            type: 'post',
                            data: {
                                ID: sgId
                            },
                            success: function (data) {
                                if (!data.code) {

                                    //加载树数据
                                    $.ajax({
                                        url: protocols.getUnit,
                                        type: 'get',
                                        cache: false,
                                        data: {},
                                        success: function (data) {
                                            if (!data.code) {
                                                toastr.success(data.msg);
                                                zNodes = treeDataReconstruct(data.rows);

                                                //console.log(d);
                                            }
                                            //渲染zTree
                                            ztree = $.fn.zTree.init($("#treeUnit"), setting, zNodes);
                                        },
                                        error: function (data) {
                                            alert(data.msg)
                                        }
                                    });
                                }
                            },
                            error: function (data) {
                                alert(data.msg)
                            }
                        });
                    }
                });

            }

        }
        //新增项目单位（施工）窗口
        function addSgModal() {
            var sgId = getUnitId();
//                vm.sgUnit_Info.ID=sgId;
            $.ajax({
                url:protocols.addSg,
                type:'post',
                data:{
                    ID:sgId,
                    NAME:$('#sgName').val(),
                    NO:$('#sgNo').val(),
                    UNO:$('#sgBNo').val(),
                    MANAGER:$('#sgManager').val(),
                    PSTART:$('#pstartDate').val(),
                    PEND:$('#pEndDate').val(),
                    SSTART:$('#sStartDate').val(),
                    SEND:$('#sEndDate').val(),
                    REK:$('#remark').val(),
                },
                success:function (data) {
                    if(!data.code){
                        $('#sgName').attr('data-sgId','');
                        $('#sgName').val('');
                        $('#sgNo').val('');
                        $('#sgBNo').val('');
                        $('#sgManager').val('');
                        $('#pstartDate').val('');
                        $('#pEndDate').val('');
                        $('#sStartDate').val('');
                        $('#sEndDate').val('');
                        $('#remark').val('');
                        $('#SgModal').modal('hide');
                        window.location.reload();
                    }
                },
                error:function(data){
                    alert(data.msg)
                }
            });
//                alert(vm.sgUnit_Info.NAME);
        }
        //编辑项目单位（施工）窗口
        function editSgModal() {
//                vm.sgUnit_Info.ID= $('#sgName').attr('data-sgId');
//            console.log($('#sgName').val());
            $.ajax({
                url:protocols.editSg,
                type:'post',
                data:{
                    ID:$('#sgName').attr('data-sgId'),
                    NAME:$('#sgName').val(),
                    NO:$('#sgNo').val(),
                    UNO:$('#sgBNo').val(),
                    MANAGER:$('#sgManager').val(),
                    PSTART:$('#pstartDate').val(),
                    PEND:$('#pEndDate').val(),
                    SSTART:$('#sStartDate').val(),
                    SEND:$('#sEndDate').val(),
                    REK:$('#remark').val(),
                },
                success:function (data) {
//                    alert(data.msg);
                    if(!data.code){
                        $('#sgForm>input').val('');
                        $('#SgModal').modal('hide');
                        toastr.success(data.msg);
//                        alert(window.contentWindow.zNodes);
                        window.location.reload();
                    }
                },
                error:function(data){
                    alert(data.msg)
                }
            });
//                alert(vm.sgUnit_Info.NAME);
        }
        //附加属性
        function attrModal() {
            var ownerId = $('#unitTable>tbody>tr.table-selected').attr('data-buid');
//            if(sgId){
            if(ownerId){
                $('#attrDataModal').modal('show');
//                var ownerId = sgId;
                $('#attrTable').attr('data-ownerid',ownerId);
                $.ajax({
                    url:protocols.getOtherAttr,
                    type:'post',
                    data:{
                        OWNERID:ownerId
                    },
                    success:function (data) {
                        if(!data.code){
                            if(data.rows.length){
                                $('#attrTable>tbody').empty();
                                $('#attrTable').attr('data-ownerid',data.rows[0].OwnerID);
                                $.each(data.rows,function (i,o) {
                                    var t = '<tr data-pid="'+o.PID+'" data-pname="'+o.PName+'"><td>'+(i+1)+'<td class="pComment">'+o.PComment+'</td>'+
                                        '<td class="pVal">'+o.PValue+'</td></tr>';
                                    $('#attrTable>tbody').append(t);
                                });
                                $('#attrTable>tbody td').on('click',function () {
                                    $(this).parent().addClass('table-selected');
                                    $(this).parent().siblings().removeClass('table-selected');
                                });
                            }else{
                                $('#attrTable>tbody>tr>td').text('暂无数据')
                            }
                        }
                    },
                    error:function (data) {
                        alert(data.msg)
                    }
                });
            }else{
//                alert('请选择项目');
                window.wxc.xcConfirm('请选择项目', window.wxc.xcConfirm.typeEnum.confirm);
            }

        }
        function showAttrAdd() {
            var ownerId = $('#attrTable').attr('data-ownerId');
            console.log(ownerId);
            $('#otherAttrModal').attr('data-ownerid',ownerId);
            $('#otherAttrModalLabel').text('添加附加属性');
            $('#otherAttrModal input').val('');
            $('#addAttrSub').css('display','inline-block');
            $('#editAttrSub').css('display','none');
            $.ajax({
                url:protocols.getAttr,
                type:'post',
                data:{
                    FLAG:"buildunit"
                },
                cache:'false',
                success:function (data) {
                    if(!data.code){
                        $('#sxName').empty();
                        $('#sxName').append('<option checked="checked">请选择属性</option>')
                        if(data.rows.length){
                            $.each(data.rows,function (i,o) {
                                var o = '<option data-pname="'+o.PName+'">'+o.PComment+'</option>';
                                $('#sxName').append(o);
                            });
                        }
                        $('#otherAttrModal').modal('show');
                    }else{
                        alert(data.msg)
                    }
                },
                error:function (data) {
                    alert(data.msg)
                }
            });

        }
        function showAttrEdit() {
            var ownerId = $('#attrTable').attr('data-ownerId');
            var pId = $('#attrTable>tbody>tr.table-selected').attr('data-pid');
            var pName = $('#attrTable>tbody>tr.table-selected').attr('data-pname');
            var pVal =  $('#attrTable>tbody>tr.table-selected>td.pVal').text();
            console.log(pVal)
            console.log(ownerId);
            if(pId){
                $('#otherAttrModal').attr('data-ownerid',ownerId);
                $('#otherAttrModal').attr('data-pid',pId);
                $('#otherAttrModalLabel').text('修改附加属性');
                $('#otherAttrModal input').val('');
                $('#addAttrSub').css('display','none');
                $('#editAttrSub').css('display','inline-block');
                $.ajax({
                    url:protocols.getAttr,
                    type:'post',
                    data:{
                        FLAG:"buildunit"
                    },
                    cache:'false',
                    success:function (data) {
                        if(!data.code){
                            $('#sxName').empty();
                            $('#sxName').append('<option checked="checked">请选择属性</option>')
                            if(data.rows.length){
                                $.each(data.rows,function (i,o) {
                                    var o = '<option id="'+o.PName+'" data-pname="'+o.PName+'">'+o.PComment+'</option>';
                                    $('#sxName').append(o);
                                });
                            }
                            var idSel = '#'+pName;
                            console.log(idSel)
                            $(idSel).attr('selected',true);
                            $('#attrVal').val(pVal)
                            $('#otherAttrModal').modal('show');
                        }else{
                            alert(data.msg)
                        }
                    },
                    error:function (data) {
                        alert(data.msg)
                    }
                });
            }else{
//                alert('请选择属性');
                window.wxc.xcConfirm('请选择属性', window.wxc.xcConfirm.typeEnum.confirm);
            }


        }
        function delAttr() {
            var pId  = $('#attrTable>tbody>tr.table-selected').attr('data-pid');
            var ownerId = $('#attrTable').attr('data-ownerid');
            if(pId){
                $.ajax({
                    url:protocols.delOtherAttr,
                    type:'post',
                    data:{
                        PID:pId,
                    },
                    success:function (data) {
                        if(!data.code){
                            $.ajax({
                                url:protocols.getOtherAttr,
                                type:'post',
                                data:{
                                    OWNERID:ownerId
                                },
                                success:function (data) {
                                    if(!data.code){
                                        toastr.success(data.msg);
                                        if(data.rows.length){
                                            $('#attrTable>tbody').empty();
                                            $('#attrTable').attr('data-ownerid',data.rows[0].OwnerID);
                                            $.each(data.rows,function (i,o) {
                                                var t =  '<tr data-pid="'+o.PID+'" data-pname="'+o.PName+'"><td>'+(i+1)+'<td class="pComment">'+o.PComment+'</td>'+
                                                        '<td class="pVal">'+o.PValue+'</td></tr>';
                                                $('#attrTable>tbody').append(t);
                                            });
                                            $('#attrTable>tbody td').on('click',function () {
                                                $(this).parent().addClass('table-selected');
                                                $(this).parent().siblings().removeClass('table-selected');
                                            });
                                        }else{
                                            $('#attrTable>tbody>tr>td').text('暂无数据')
                                        }
                                        $('#otherAttrModal').modal('hide');
                                    }
                                },
                                error:function (data) {
                                    alert(data.msg)
                                }
                            });
                        }
                    }
                });
            }else{
//                alert('请选择属性');
                window.wxc.xcConfirm('请选择属性', window.wxc.xcConfirm.typeEnum.confirm);
            }
        }
        function subAddAttrBtn() {
            var pid = getUnitId();
            var ownerId = $('#otherAttrModal').attr('data-ownerid')
            $.ajax({
                url:protocols.addOtherAttr,
                type:'post',
                data:{
                   PID:pid,
                   PNAME:$('#sxName>option:checked').attr('data-pname'),
                   PVALUE:$('#attrVal').val(),
                   OWNERID:ownerId,
                   COMMENT:$('#sxName>option:checked').text(),
                },
                success:function (data) {
                    if(!data.code){
                        $.ajax({
                            url:protocols.getOtherAttr,
                            type:'post',
                            data:{
                                OWNERID:ownerId
                            },
                            success:function (data) {
                                if(!data.code){
                                    toastr.success(data.msg);
                                    if(data.rows.length){
                                        $('#attrTable>tbody').empty();
                                        $('#attrTable').attr('data-ownerid',data.rows[0].OwnerID);
                                        $.each(data.rows,function (i,o) {
                                            var t =  '<tr data-pid="'+o.PID+'" data-pname="'+o.PName+'"><td>'+(i+1)+'<td class="pComment">'+o.PComment+'</td>'+
                                                    '<td class="pVal">'+o.PValue+'</td></tr>';
                                            $('#attrTable>tbody').append(t);
                                        });
                                        $('#attrTable>tbody td').on('click',function () {
                                            $(this).parent().addClass('table-selected');
                                            $(this).parent().siblings().removeClass('table-selected');
                                        });
                                    }else{
                                        $('#attrTable>tbody>tr>td').text('暂无数据')
                                    }
                                    $('#otherAttrModal').modal('hide');
                                }
                            },
                            error:function (data) {
                                alert(data.msg)
                            }
                        });
                    }
                },
                error:function (data){
                    alert(data.msg)
                }
            })
        }
        function subEditAttrBtn() {
            var pid  = $('#otherAttrModal').attr('data-pid');
            var ownerId = $('#otherAttrModal').attr('data-ownerid');
            $.ajax({
                url:protocols.editOtherAttr,
                type:'post',
                data:{
                    PID:pid,
                    PNAME:$('#sxName>option:checked').attr('data-pname'),
                    PVALUE:$('#attrVal').val(),
                    OWNERID:ownerId,
                    COMMENT:$('#sxName>option:checked').text(),
                },
                success:function (data) {
                    if(!data.code){
                        $.ajax({
                            url:protocols.getOtherAttr,
                            type:'post',
                            data:{
                                OWNERID:ownerId
                            },
                            success:function (data) {
                                if(!data.code){
                                    toastr.success(data.msg);
                                    if(data.rows.length){
                                        $('#attrTable>tbody').empty();
                                        $('#attrTable').attr('data-ownerid',data.rows[0].OwnerID);
                                        $.each(data.rows,function (i,o) {
                                            var t =  '<tr data-pid="'+o.PID+'"><td>'+(i+1)+'<td class="pComment">'+o.PComment+'</td>'+
                                                    '<td class="pVal">'+o.PValue+'</td></tr>';
                                            $('#attrTable>tbody').append(t);
                                        });
                                        $('#attrTable>tbody td').on('click',function () {
                                            $(this).parent().addClass('table-selected');
                                            $(this).parent().siblings().removeClass('table-selected');
                                        });
                                    }else{
                                        $('#attrTable>tbody>tr>td').text('暂无数据')
                                    }
                                    $('#otherAttrModal').modal('hide');
                                }
                            },
                            error:function (data) {
                                alert(data.msg)
                            }
                        });
                    }
                },
                error:function (data){
                    alert(data.msg)
                }
            })
        }

        //计划时间模态框
        function planTimeBtn() {
            var buId = $('#unitTable>tbody>tr.table-selected').attr('data-buid');
            var pstartTime = $('#unitTable>tbody>tr.table-selected>td.pstart').text();
            var pendTime = $('#unitTable>tbody>tr.table-selected>td.pend').text();
            planTimeAllContent ={
                ID:buId,
                NAME:$('#unitTable>tbody>tr.table-selected>td.buName').text(),
                NO:$('#unitTable>tbody>tr.table-selected').attr('data-no'),
                UNO:$('#unitTable>tbody>tr.table-selected>td.uNo').text(),
                REK:$('#unitTable>tbody>tr.table-selected>td.remark').text(),
                PSTART:pstartTime,
                PEND:pendTime,
                SSTART:$('#unitTable>tbody>tr.table-selected>td.sStart').text(),
                SEND: $('#unitTable>tbody>tr.table-selected>td.sEnd').text(),
                MANAGER: $('#unitTable>tbody>tr.table-selected>td.buManager').text(),
            };
            console.log(buId)
            if(buId){
                $('#planTimeForm input').val();
                $('#planTimeForm #startTime').val(pstartTime);
                $('#planTimeForm #endTime').val(pendTime);
                $('#planTimeModal').modal('show');
            }else{
                window.wxc.xcConfirm('请选择项目', window.wxc.xcConfirm.typeEnum.confirm);
            }
        }
        //实际时间模态框
        function sjTimeBtn () {
            var buId = $('#unitTable>tbody>tr.table-selected').attr('data-buid');
            var sstartTime = $('#unitTable>tbody>tr.table-selected>td.sStart').text();
            var sendTime = $('#unitTable>tbody>tr.table-selected>td.sEnd').text();
            console.log(buId);
            console.log(sstartTime);
            actuallyAllContent={
                ID:buId,
                NAME:$('#unitTable>tbody>tr.table-selected>td.buName').text(),
                NO:$('#unitTable>tbody>tr.table-selected').attr('data-no'),
                UNO:$('#unitTable>tbody>tr.table-selected>td.uNo').text(),
                REK:$('#unitTable>tbody>tr.table-selected>td.remark').text(),
                PSTART: $('#unitTable>tbody>tr.table-selected>td.pstart').val(),
                PEND:$('#unitTable>tbody>tr.table-selected>td.pend').val(),
                SSTART:sstartTime,
                SEND: sendTime,
                MANAGER: $('#unitTable>tbody>tr.table-selected>td.buManager').text(),
            };
            if(buId){
                $('#sjTimeForm input').val();
                $('#sjTimeForm #sstartTime').val(sstartTime);
                $('#sjTimeForm #sendTime').val(sendTime);
                $('#actuallyTimeModal').modal('show');
            }else{
                window.wxc.xcConfirm('请选择项目', window.wxc.xcConfirm.typeEnum.confirm);
            }
        }
        
        //计划时间 实际时间提交
        function editPlanTimeBtn() {
            planTimeAllContent.PSTART =  $('#planTimeForm #startTime').val();
            planTimeAllContent.PEND = $('#planTimeForm #endTime').val();
            $.ajax({
                url:protocols.editSg,
                type:'post',
                data:planTimeAllContent,
                success:function (data) {
                    console.log(data.code)
                    if(!data.code){
                        $('#unitTable>tbody>tr.table-selected>td.pstart').text(planTimeAllContent.PSTART);
                        $('#unitTable>tbody>tr.table-selected>td.pend').text(planTimeAllContent.PEND);
                        $('#unitTable>tbody>tr').removeClass('table-selected');
                        $('#planTimeModal').modal('hide')
                    }else{
                        window.wxc.xcConfirm(data.msg, window.wxc.xcConfirm.typeEnum.warning);
                    }
                }
            });
        }
        function editSjTimeBtn() {
            actuallyAllContent.SSTART =  $('#sjTimeForm #sstartTime').val();
            actuallyAllContent.SEND = $('#sjTimeForm #sendTime').val();
            $.ajax({
                url:protocols.editSg,
                type:'post',
                data:actuallyAllContent,
                success:function (data) {
                    console.log(data.code)
                    if(!data.code){
                        $('#unitTable>tbody>tr.table-selected>td.sStart').text(actuallyAllContent.SSTART);
                        $('#unitTable>tbody>tr.table-selected>td.sEnd').text(actuallyAllContent.SEND);
                        $('#unitTable>tbody>tr').removeClass('table-selected');
                        $('#actuallyTimeModal').modal('hide')
                    }else{
                        window.wxc.xcConfirm(data.msg, window.wxc.xcConfirm.typeEnum.warning);
                    }
                }
            });
        }
        //查看所有属性
        function seeAllBtn() {
            var buId = $('#unitTable>tbody>tr.table-selected').attr('data-buid');
            var NAME =$('#unitTable>tbody>tr.table-selected>td.buName').text();
            var NO= $('#unitTable>tbody>tr.table-selected').attr('data-no');
            var UNO= $('#unitTable>tbody>tr.table-selected>td.uNo').text();
            var REK = $('#unitTable>tbody>tr.table-selected>td.remark').text();
            var PSTART=$('#unitTable>tbody>tr.table-selected>td.pstart').text();
            var  PEND =$('#unitTable>tbody>tr.table-selected>td.pend').text();
            var SSTART=$('#unitTable>tbody>tr.table-selected>td.sStart').text();
            var SEND= $('#unitTable>tbody>tr.table-selected>td.sEnd').text();
            var MANAGER=$('#unitTable>tbody>tr.table-selected>td.buManager').text();
            if(buId){
                console.log(UNO)
                $('#allAttrTable .allBasicAttr .buno').text(UNO);
                $('#allAttrTable .allBasicAttr .buname').text(NAME)
                $('#allAttrTable .allBasicAttr .bumanager').text(MANAGER)
                $('#allAttrTable .allBasicAttr .pstart').text(PSTART)
                $('#allAttrTable .allBasicAttr .pend').text(PEND)
                $('#allAttrTable .allBasicAttr .sstart').text(SSTART)
                $('#allAttrTable .allBasicAttr .send').text(SEND)
                $('#allAttrTable .allBasicAttr .remark').text(REK)
                $.ajax({
                    url:protocols.getOtherAttr,
                    type:'post',
                    data:{
                        OWNERID:buId
                    },
                    success:function (data) {
                        if(!data.code){
                            $('#allAttrTable tbody.allOtherAttr').empty();
                            $.each(data.rows,function (i,o) {
                                var t = '<tr>' +
                                        '<td>'+(9+i)+'</td><td>'+o.PComment+'</td><td>'+o.PValue+'</td></tr>';
                                $('#allAttrTable tbody.allOtherAttr').append(t)
                            })
                        }
                    }
                })
                $('#allAttrModal').modal('show')
            }else{
                window.wxc.xcConfirm('请选择项目', window.wxc.xcConfirm.typeEnum.confirm);
            }
        }
        //32Id随机值
        function getUnitId() {
            var chars = ['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
            var res = "";
            for(var i = 0; i < 32 ; i ++) {
                var id = Math.ceil(Math.random()*35);
                res += chars[id];
            }
            return res;

        }
    })(window.jQuery)
</script>
</body>
</html>